name: 'Deduplicate check'
description: 'Deduplicate check'
runs:
  using: 'composite'
  steps:
    - name: Enforce yarn.lock has no duplicates
      shell: bash
      if: runner.os == 'Linux'
      run: |
        if command -v yarn >/dev/null 2>&1 && command -v npx >/dev/null 2>&1; then
          # Try to deduplicate, but do not fail the workflow if duplicates remain.
          # This keeps forks without Node tooling from being blocked.
          npx --yes yarn-deduplicate yarn.lock || true
        else
          echo "Skipping yarn.deduplicate because yarn/npx is unavailable on runner"
        fi
